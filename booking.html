<!DOCTYPE html>
<html lang="en">

<head>
  <meta charset="UTF-8">
  <title>Book PG</title>
  <link rel="stylesheet" href="style.css">
  <style>
    body {
      font-family: 'Segoe UI', sans-serif;
      background: #f2f2f2;
      margin: 0;
      padding: 0;
    }

    /* Header */
    header {
      background-color: #4CAF50;
      color: white;
      padding: 1.5rem;
      text-align: center;
      box-shadow: 0 2px 6px rgba(0, 0, 0, 0.1);
      position: fixed;
      top: 0;
      left: 0;
      width: 100%;
      z-index: 1000;
    }

    header h1 {
      margin: 0;
      font-size: 2rem;
    }

    /* Content */
    .booking-container {
      background-color: white;
      max-width: 600px;
      margin: 5rem auto 2rem; /* Added top margin to avoid content being hidden under the header */
      padding: 3rem;
      border-radius: 12px;
      box-shadow: 0 0 20px rgba(0, 0, 0, 0.1);
      box-sizing: border-box;
    }

    form label {
      display: block;
      margin: 1rem 0 0.5rem;
    }

    form input,
    form select,
    form textarea {
      width: 100%;
      padding: 12px;
      border: 1px solid #ccc;
      border-radius: 8px;
      font-size: 1rem;
      box-sizing: border-box;
    }

    form button {
      margin-top: 1.5rem;
      width: 100%;
      padding: 12px;
      background-color: #4CAF50;
      border: none;
      color: white;
      font-size: 1rem;
      border-radius: 8px;
      cursor: pointer;
      box-sizing: border-box;
    }

   

    .checkbox-label {
    display: flex;
    align-items: center;
    font-size: 1rem;
    margin-top: 1rem;
    gap: 8px;
  }

  .checkbox-label input[type="checkbox"] {
    width: 18px;
    height: 18px;
    border-radius: 4px;
    border: 1px solid #ccc;
    cursor: pointer;
    accent-color: #4CAF50; /* Set the checkbox color */
  }

  .checkbox-label span {
    font-size: 1rem;
  }

  .checkbox-label input[type="checkbox"]:checked {
    background-color: #4CAF50;
    border-color: #4CAF50;
  }

  .checkbox-label input[type="checkbox"]:focus {
    outline: none;
    box-shadow: 0 0 3px 2px rgba(76, 175, 80, 0.4);
  }

    /* Modal styling */
    .modal {
      display: none;
      position: fixed;
      top: 0;
      left: 0;
      width: 100%;
      height: 100%;
      background: rgba(0, 0, 0, 0.6);
      justify-content: center;
      align-items: center;
      z-index: 1000;
    }

    .modal-content {
      background: white;
      padding: 2rem;
      border-radius: 12px;
      width: 90%;
      max-width: 500px;
    }

    .modal h3 {
      margin-top: 0;
    }

    .modal button {
      margin-top: 1rem;
      width: auto;
      margin-right: 1rem;
    }

    /* Additional Styles */
    .form-header {
      font-size: 1.5rem;
      margin-bottom: 1rem;
      text-align: center;
      color: #333;
    }
  </style>
</head>

<body>
  <header>
    <h1>Book Your PG</h1>
  </header>

  <div class="booking-container">
    <h2 id="pg-title"></h2>
    <p><strong>City:</strong> <span id="pg-city"></span></p>
    <p><strong>Price:</strong> â‚¹<span id="pg-price"></span></p>

    <form id="booking-form" method="POST" onsubmit="return validateForm()">
      <h3 class="form-header">Fill the Booking Details</h3>
      <label for="name">Your Name:</label>
      <input type="text" id="name" name="name" required>

      <label for="email">Email:</label>
      <input type="email" id="email" name="email" required>

      <label for="phone">Contact Number:</label>
      <input type="tel" id="phone" name="phone" pattern="[0-9]{10}" required>

      <label for="gender">Gender:</label>
      <select id="gender" name="gender" required>
        <option value="">Select</option>
        <option>Male</option>
        <option>Female</option>
        <option>Other</option>
      </select>

      <label for="room">Room Type:</label>
      <select id="room" name="room" required>
        <option value="">Choose</option>
        <option>Single</option>
        <option>Shared</option>
        <option>AC</option>
        <option>Non-AC</option>
      </select>

      <label for="duration">Duration (months):</label>
      <input type="number" id="duration" name="duration" min="1" max="24" required>

      <label for="date">Booking Date:</label>
      <input type="date" id="date" name="date" required>

      <label for="notes">Special Requests:</label>
      <textarea id="notes" name="notes" rows="3"></textarea>



      <label for="terms" class="checkbox-label">
        <input type="checkbox" id="terms" name="terms" required>
        <span>I agree to the terms & conditions</span>
      </label>

      <button type="submit">Preview & Submit</button>
    </form>
  </div>

  <!-- Modal -->
  <div class="modal" id="previewModal">
    <div class="modal-content">
      <h3>Booking Preview</h3>
      <div id="previewData"></div>
      <button id="confirmBtn">Confirm Booking</button>
      <button onclick="closeModal()">Cancel</button>
    </div>
  </div>

  <script>
    const params = new URLSearchParams(window.location.search);
    const pgName = params.get("name");
    const pgCity = params.get("city");
    const pgPrice = params.get("price");

    document.getElementById("pg-title").textContent = pgName;
    document.getElementById("pg-city").textContent = pgCity;
    document.getElementById("pg-price").textContent = pgPrice;

    // Set min date to today
    document.getElementById("date").min = new Date().toISOString().split("T")[0];

    // Form Validation before submitting
    function validateForm() {
      const phone = document.getElementById("phone").value;

      // Validate phone
      if (!/^\d{10}$/.test(phone)) {
        alert("Enter valid 10-digit phone number");
        return false;
      }

      // Show modal for preview
      const data = ` 
        <p><strong>Name:</strong> ${document.getElementById("name").value}</p>
        <p><strong>Email:</strong> ${document.getElementById("email").value}</p>
        <p><strong>Phone:</strong> ${phone}</p>
        <p><strong>Gender:</strong> ${document.getElementById("gender").value}</p>
        <p><strong>Room:</strong> ${document.getElementById("room").value}</p>
        <p><strong>Duration:</strong> ${document.getElementById("duration").value} months</p>
        <p><strong>Booking Date:</strong> ${document.getElementById("date").value}</p>
        <p><strong>Special Requests:</strong> ${document.getElementById("notes").value}</p>
      `;
      document.getElementById("previewData").innerHTML = data;
      document.getElementById("previewModal").style.display = "flex";

      return false; // Prevent form submission
    }

    // Confirm button to simulate final booking
    document.getElementById("confirmBtn").addEventListener("click", function () {
  // Collect booking details
  const userName = document.getElementById("name").value;
  const email = document.getElementById("email").value;
  const date = document.getElementById("date").value;
  const contact = document.getElementById("phone").value;
  const pgName = document.getElementById("pg-title").textContent;
  const city = document.getElementById("pg-city").textContent;
  const price = document.getElementById("pg-price").textContent;

  // Send booking data to backend using Fetch API
  fetch("http://localhost:5000/api/booking", {
    method: "POST",
    headers: {
      "Content-Type": "application/json"
    },
    body: JSON.stringify({
      name: userName,
      email: email,
      date: date,
      contact: contact,
      pgName: pgName,
      city: city,
      price: Number(price)
    })
  })
    .then(response => response.json())
    .then(data => {
      alert("Booking Confirmed and Saved!");
      closeModal();
      // Optionally redirect or reset form here
    })
    .catch(error => {
      console.error("Error:", error);
      alert("Failed to confirm booking.");
    });
});


    function closeModal() {
      document.getElementById("previewModal").style.display = "none";
    }
  </script>
</body>

</html>